# HTTP

## 老生常谈的话题：浏览器敲下一段url后按回车, 通常会经历什么？（HTTP请求的生命周期）

> 简单点说，可以分为三个主要步骤:
	
1. `HTTP`客户端发起请求，创建端口
2. `HTTP`服务器在短期监听客户端请求
3. `HTTP`服务器想客户端返回状态和内容
	
> 形象点说，可以论述如下(以打开/刷新`baidu`为例:)：

1. `Chrome`搜索自身的`DNS`缓存（`Chromw`过期时间为`60s`,`IE`是`30min`，`Firefox`也是`60s`，`safari`约为`10s`）；
2. 浏览器没有找到或者缓存已经失效，就回去搜索操作系统自身的DNS缓存；（`Windows`缓存失效时间默认为`86400s`，也就是一天。）;
3. 读取本地的`HOSTS`文件;
4. 如果本地`HOSTS`文件也没有找到，浏览器会发起一个`DNS`的系统调用;
		
    - 宽带运营服务器查看本地缓存;
    - 运营商服务器发起一个迭代DNS解析的请求;
    - 找到之后运营商服务器把结果返回给操作系统并缓存下来，操作系统内核再把结果返回给浏览器;
    - 最终浏览器拿到了`www.baidu.com`对应的`ip`地址;
		
4. 浏览器获得域名对应的`ip`地址后，浏览器会以一个随机端口向服务器的`web`程序发起请求（`TCP`连接请求），经过层层路由、网卡、TCP协议栈、防火墙过滤，最终到达`web`服务端, 然后开始经典的三次握手；
	
    - 客户端首先向服务器说，兄弟，咱们聊聊天，听得到我说话吗？
    - 服务器说，听得到，咱来唠唠
    - 客户端再说，好的，咱们开始唠唠了    
		
6. `TCP/IP`连接建立起来以后，浏览器就能向服务器端发送`HTTP`请求了
		
7. 服务器端接受到请求，净多后端的一些处理之后，把处理后的结果返回给浏览器。把`www.baidu.com`的整个页面返回
	
8. 浏览器拿到`HTML`代码，开始解析，其中，里面的`js`、`css`、`img`等静态资源也都是一个个`HTTP`请求，都要经过上述的主要的七个步骤。
	
9. 开始对页面进行渲染。最终把一个完整的页面返回给用户。


## 如果一个域名的DNS解析结果会有多个的话，浏览器是如何处理的呢？

Chrome浏览器会优先向第一个IP发起HTTP请求，如果不通，再向后面的IP发起HTTP请求。

## 什么是HTTP协议？

HTTP 是基于 `TCP/IP` 协议的应用层协议。它不涉及数据包（packet）传输，主要规定了客户端和服务器之间的通信格式，默认使用`80`端口。

## HTTP 常用的Header有哪些？

属性|描述
---|---
Content-Type: text/html | 标识资源的类型编码（`MIME type`）
Content-Encoding: gzip | 标识资源的压缩方法
Connection: keep-alive | ，可以解决`HTTP/1.0`每个TCP连接只能发一个请求的缺陷，使用 `keep-alive` 可以实现一个可复用的TCP连接，但是这非标准。
Connection: close | 由于`HTTP/1.1`默认引入了持久连接，因此好的做法是在客户端最后一个请求，发送 `Connection: close` 关闭TCP连接
Content-Length : 1994 | 声明数据长度（单位是字节）

## `HTTP/1.1`有哪些特性？

1. 持久连接；
2. 管道机制；
3. Content-Length 字段
4. 分块传输编码（采用"流模式"（stream）取代"缓存模式"（buffer））：`Transfer-Encoding: chunked`
5。 

