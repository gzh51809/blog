<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>测试浏览器事件模型</title>
</head>
<body>

<div id="btn-wrapper">
	<button id="btn">BUTTON</button>
</div>

<script src="//cdn.bootcss.com/babel-core/5.8.38/browser.js"></script>
<script src="//cdn.bootcss.com/lodash.js/4.17.4/lodash.js"></script>
<script>

	// 外观模式
	function addEvent(el, type, fn) {
		// 对于支持DOM2事件优先用DOM2
		if (el.addEventListener) {
			// false 代表只在冒泡阶段触发事件
			el.addEventListener(type, fn, false)
			// 对于不支持 addEventListener 但支持 attachEvent 的
		} else if (el.attachEvent) {
			el.attachEvent('on' + type, fn)
			// 对于不支持 addEventListener 也不支持 attachEvent 的
		} else {
			el['on' + type] = fn;
		}
	}

	// HTMLCollection
	const body = document.getElementsByTagName('body')[0]
	// HTMLDivElement - HTMLElement -  Element
	const btnWrapper = document.getElementById('btn-wrapper')
	const btn = document.getElementById('btn')

	function triggerEvent(event) {
		console.log('this = ' + this.tagName)
		console.log('event.target = ' + event.target.tagName)
		const tagName = event.currentTarget.tagName
		const stage = event.eventPhase
		if (stage === 1) {
			console.warn('捕获阶段： ' + tagName)
		} else if (stage === 2) {
			console.warn('目标阶段： ' + tagName)
		} else if (stage === 3) {
			console.warn('冒泡阶段： ' + tagName)
		}
		// 终止事件在传播过程的捕获、目标处理或起泡阶段进一步传播。
		// event.preventDefault()
	}

	addEvent(body, 'click', triggerEvent)
	addEvent(btnWrapper, 'click', triggerEvent)
	addEvent(btn, 'click', triggerEvent)
	
</script>

</body>
</html>